(()=>{"use strict";function e(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var n=document.createElement("style");n.textContent="\n  .fejka-input-icon {\n    cursor: pointer;\n    position: fixed;\n    width: 16px;\n    height: 16px;\n    opacity: 0;\n    transition: opacity 0.2s;\n    z-index: 1000;\n    pointer-events: auto;\n    margin-left: 8px; /* Add margin to separate from input */\n  }\n  .fejka-input-icon:hover {\n    opacity: 1 !important;\n  }\n  .fejka-input-wrapper {\n    position: static !important;\n    display: contents !important;\n  }\n  .fejka-context-menu {\n    position: fixed;\n    background: white;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-shadow: 0 2px 5px rgba(0,0,0,0.2);\n    padding: 0;\n    z-index: 1001;\n    display: none;\n    overflow: hidden;\n  }\n  .fejka-context-menu.active {\n    display: block;\n  }\n  .fejka-menu-item {\n    padding: 8px 12px;\n    cursor: pointer;\n    white-space: nowrap;\n    font-size: 14px;\n    color: #333;\n  }\n  .fejka-menu-item:hover {\n    background-color: #f0f0f0;\n  }\n",document.head.appendChild(n);var a=document.createElement("div");function r(e){if(!e.dataset.fejkaProcessed&&"hidden"!==e.type&&"none"!==e.style.display&&"hidden"!==e.style.visibility&&!["submit","button","reset","image","file","hidden"].includes(e.type)){var t=e.getBoundingClientRect();if(!(t.width<50||t.height<20)){e.dataset.fejkaProcessed="true";var n=document.createElement("img");n.src=chrome.runtime.getURL("images/icon16.png"),n.className="fejka-input-icon",n.title="Generate fake data";var r=function(e,t){var n=function(){var n=e.getBoundingClientRect();0!==n.width&&0!==n.height?(window.getComputedStyle(e),t.style.top="".concat(n.top+(n.height-16)/2,"px"),t.style.left="".concat(n.right+4,"px"),t.style.display="block"):t.style.display="none"};return document.addEventListener("scroll",n,!0),window.addEventListener("resize",n),new MutationObserver(n).observe(document.body,{attributes:!0,childList:!0,subtree:!0,characterData:!0}),n}(e,n);!function(e,t,n){e.addEventListener("focus",(function(){n(),t.style.opacity="0.6",document.body.appendChild(t)})),e.addEventListener("focusout",(function(e){setTimeout((function(){t.contains(document.activeElement)||(t.style.opacity="0",document.body.removeChild(t))}),100)})),t.addEventListener("mousedown",(function(e){e.preventDefault()}))}(e,n,r),r(),n.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation();var n=t.target.getBoundingClientRect();a.style.top=n.bottom+"px",a.style.left=n.left+"px",a.classList.add("active"),a.dataset.currentField=e.id||e.name||""}))}}}function i(e){var t=0;return document.querySelectorAll("input, textarea, select").forEach((function(n){["submit","button","reset","image","file","hidden"].includes(n.type)||o(n,e)&&t++})),t}function o(t,n){var a,r,i,o,u,l,s,d=[null===(a=t.id)||void 0===a?void 0:a.toLowerCase(),null===(r=t.name)||void 0===r?void 0:r.toLowerCase(),null===(i=t.getAttribute("data-field"))||void 0===i?void 0:i.toLowerCase(),null===(o=t.placeholder)||void 0===o?void 0:o.toLowerCase(),null===(u=t.getAttribute("aria-label"))||void 0===u?void 0:u.toLowerCase(),null===(l=t.getAttribute("blazor:bindings"))||void 0===l?void 0:l.toLowerCase(),null===(s=t.getAttribute("_bl_"))||void 0===s?void 0:s.toLowerCase()].filter(Boolean),f=document.querySelectorAll('label[for="'.concat(t.id,'"]'));f.length>0&&d.push(f[0].textContent.toLowerCase().trim());var p,m,v=!1;if("email"===t.type&&n.email)v=c(t,n.email);else if("tel"===t.type&&n.phone)v=c(t,n.phone);else{var h,b=function(t){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=e(t))){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(d);try{for(b.s();!(h=b.n()).done;){var y,g=h.value;if(g)if(g.includes("name")){if(g.includes("first")||g.includes("fname")){if(n.fname?v=c(t,n.fname):n.name&&n.name.includes(" ")&&(v=c(t,n.name.split(" ")[0])),v)break}else if(g.includes("last")||g.includes("lname")){if(n.lname?v=c(t,n.lname):n.name&&n.name.includes(" ")&&(v=c(t,n.name.split(" ").slice(-1)[0])),v)break}else if(n.name&&(v=c(t,n.name)))break}else{for(var k={street:function(){return n.street},city:function(){return n.city},zip:function(){return n.zip},postal:function(){return n.zip},gender:function(){return n.gender},phone:function(){return n.phone},email:function(){return n.email},pnr:function(){return n.pnr},ssn:function(){return n.pnr},socialsecuritynumber:function(){return n.pnr},personnummer:function(){return n.pnr},personal:function(){return n.pnr},age:function(){return n.age},address:function(){return n.address}},w=0,x=Object.entries(k);w<x.length;w++){var j=(p=x[w],m=2,function(e){if(Array.isArray(e))return e}(p)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i,o,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(a=i.call(n)).done)&&(c.push(a.value),c.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw r}}return c}}(p,m)||e(p,m)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),L=j[0],E=j[1];if(g===L||g.includes(L.toLowerCase())){var A=E();if(A&&(v=c(t,A)))break}}if(!v&&null!==(y=t.placeholder)&&void 0!==y&&y.match(/^\d{8}-\d{4}$/)&&(v=c(t,n.pnr)),v)break}}}catch(e){b.e(e)}finally{b.f()}}return v}function c(e,t){if(!e||null==t)return!1;try{return e.value,e.value=t,["input","change"].forEach((function(t){var n=new Event(t,{bubbles:!0,cancelable:!0});e.dispatchEvent(n)})),(e.hasAttribute("blazor:bindings")||e.hasAttribute("_bl_"))&&setTimeout((function(){e.dispatchEvent(new Event("blur",{bubbles:!0}))}),100),e.value===t}catch(e){return!1}}a.className="fejka-context-menu",a.innerHTML='\n  <div class="fejka-menu-item" data-action="populate-current">Populate Current Field</div>\n  <div class="fejka-menu-item" data-action="populate-all">Populate All Fields</div>\n  <div class="fejka-menu-item" data-action="generate-populate">Generate New & Populate All</div>\n',document.body.appendChild(a),new MutationObserver((function(e){e.forEach((function(e){e.addedNodes.forEach((function(e){1===e.nodeType&&(e.querySelectorAll("input, textarea, select").forEach((function(e){return r(e)})),e.matches("input, textarea, select")&&r(e))}))}))})).observe(document.body,{childList:!0,subtree:!0}),document.querySelectorAll("input, textarea, select").forEach((function(e){["submit","button","reset","image","file","hidden"].includes(e.type)||r(e)})),chrome.runtime.onMessage.addListener((function(e,t,n){if("populateForm"===e.action)return n({success:!0,fieldsPopulated:i(e.data)}),!0})),document.addEventListener("click",(function(e){e.target.closest(".fejka-context-menu")||e.target.closest(".fejka-input-icon")||a.classList.remove("active")})),a.addEventListener("click",(function(e){var t=e.target.closest(".fejka-menu-item");if(t){var n=t.dataset.action;switch(a.classList.remove("active"),n){case"populate-current":chrome.storage.local.get("fejkaPersonData",(function(e){if(e.fejkaPersonData){var t=document.querySelector("#".concat(a.dataset.currentField))||document.querySelector('[name="'.concat(a.dataset.currentField,'"]'));t&&o(t,e.fejkaPersonData)}else chrome.runtime.sendMessage({action:"fetchData",params:{}},(function(e){if(e&&e.data){var t=e.data,n=document.querySelector("#".concat(a.dataset.currentField))||document.querySelector('[name="'.concat(a.dataset.currentField,'"]'));n&&o(n,t)}}))}));break;case"populate-all":chrome.storage.local.get("fejkaPersonData",(function(e){e.fejkaPersonData?i(e.fejkaPersonData):chrome.runtime.sendMessage({action:"fetchData",params:{}},(function(e){e&&e.data&&i(e.data)}))}));break;case"generate-populate":chrome.runtime.sendMessage({action:"fetchData",params:{}},(function(e){if(e&&e.data){var t=e.data;chrome.storage.local.set({fejkaPersonData:t},(function(){i(t),setTimeout((function(){chrome.runtime.sendMessage({action:"updatePopupData",data:t,updateStorage:!0}).catch((function(){}))}),0)}))}}))}}}))})();